# Azure

## Logearse en Azure mediante AZ CLI

az login

az account show

## En Windows con PowerShell (mi caso)

Ejecutar los siguientes comandos con el id y tenant_id que devuelve "az account show"

- $Env:ARM_SUBSCRIPTION_ID = ""
- $Env:ARM_TENANT_ID = ""


# Terraform

## Crear infraestructura

terraform init -upgrade
terraform plan -out infra.tfplan
terraform apply infra.tfplan


## Destruir infraestructura

terraform plan -destroy -out infra.destroy.tfplan
terraform apply infra.destroy.tfplan


# Ansible


## Almacen de credenciales

Para hacer login con Azure y el ACR se puede utilizar Ansible Vault

Un fichero "azure_vault.yml" con la siguiente estructura:

ACR_USR: ""
ACR_PASS: ""

Donde los valores vienen dados por el comando de Azure CLI visto previamente.

Encriptar datos utilizando :
- ansible-vault encrypt azure_vault.yml

Luego lanzar el playbook con el flag "--ask-vault-pass"


* Por seguridad en este repositorio el fichero azure_vault.yml estar√° ignorado en GIT